import base64
import json
from pprint import pprint
from time import sleep
from config import key, secret, passphrase
import cbpro

encoded = json.dumps(secret).encode()
b64secret = base64.b64encode(encoded)
auth_client = cbpro.AuthenticatedClient(key=key, b64secret=secret, passphrase=passphrase,
                                        api_url="https://api.exchange.coinbase.com")
try:
    d = auth_client.get_fills(product_id='BTC-USD', )

    print("ticker")
    pprint(dir(d))
    while True:
        try:
            pprint(str(d.next()))
        except StopIteration:
            break

except Exception as e:
    print('Error obtaining ticker data: ' + str(e))
